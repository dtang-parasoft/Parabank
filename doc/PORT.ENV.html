<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Do not use the non-portable 'System.getenv()' method [PORT.ENV]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Do not use the non-portable 'System.getenv()' method [PORT.ENV]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

This rule identifies the use of 'System.getenv()'.  An error is reported for 
each occurrence.  

The 'System.getenv()' method was deprecated in versions of the JDK prior to
version 1.5.  As of JDK version 1.5, it is no longer deprecated; however, it is 
still not guaranteed to work on all systems.  According to the Javadoc for the 
"System" class, "If the system does not support environment variables, an empty 
map is returned."  This means that it is dangerous for your code to rely on 
using environment variables.  In practice, most modern systems support 
environment variables, but there are still some that do not.  In versions of the
JDK prior to version 1.5, use of the 'System.getenv()' method could cause an
exception to be thrown.  This means that you should never use this method when
using versions of the JDK prior to version 1.5.  If you would like to allow use
of this method when the JDK is version 1.5 or later, you should enable the 
parameter.



</PRE>
<STRONG>
SCOPE LEVEL
</STRONG>
<PRE>
LINE



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v4.5


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Exposing Sensitive Data
category: Code Quality

Violating this rule could cause security vulnerabilities.  Accesses to 
environment variables could indicate places where data which should not be 
accessed or modified by the user is being accessed or modified.  You should
inspect all usages of 'System.getenv()' to ensure that they are legitimate.


</PRE>
<STRONG>
PARAMETERS
</STRONG>
<PRE>

-Ignore code which uses JDK 1.5 or later
    -Default is "false"
    -The 'System.getenv()' method is no longer deprecated as of JDK 1.5 because
     the implementation was changed.  See the discussion in the "DESCRIPTION"
     section for more details.  If you would like to allow use of this method
     when the JDK is set at 1.5 or later because the method is no longer 
     deprecated, you should enable this parameter.


</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

'System.getenv()' was "deprecated" in JDK versions prior to version 1.5 because 
it was not portable.  While the method is no longer deprecated, it is still not
guaranteed to be portable.  Not all platforms have environment variables.  
According to the Javadoc for the "System" class, "If the system does not support 
environment variables, an empty map is returned."  You cannot rely on this 
method because it will not work on all systems.


</PRE>
<STRONG>
DRAWBACKS
</STRONG>
<PRE>

Your users may be unfamiliar with how to change Java properties.


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

package examples.rules.port;

public class ENV {
    void method (String name) {
        System.getenv (name);  // VIOLATION
    }
}


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Use 'System.getProperty()' and the corresponding 'getTypeName()' methods of
the "boolean", "integer", and "long" primitive types.  This will retrieve Java
system properties instead of environment variables.

package examples.rules.port;

public class ENVFixed {
    void method (String name) {
        System.getProperty (name);  // FIXED
    }
}


</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

David Flanagan: "Java in a Nutshell".  O'Reilly
November, 1999: Third Edition, pp.190-192

SEI CERT Oracle Coding Standard for Java
ENV02-J. Do not trust the values of environment variables
<A HREF="https://wiki.sei.cmu.edu/confluence/display/java/ENV02-J.+Do+not+trust+the+values+of+environment+variables">https://wiki.sei.cmu.edu/confluence/display/java/ENV02-J.+Do+not+trust+the+values+of+environment+variables</A>

</PRE>
</BODY>
</HTML>
