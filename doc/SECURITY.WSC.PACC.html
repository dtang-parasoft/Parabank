<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Call access control methods to enforce consistency [SECURITY.WSC.PACC]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Call access control methods to enforce consistency [SECURITY.WSC.PACC]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

This rule identifies method declarations which do not contain required access
control method invocations. An error is reported for each declaration matching
one of the user-specified regular expressions which does not contain a call to 
a centralized access control method (Centralized access control methods are 
specified in the parameters). 



</PRE>
<STRONG>
SCOPE LEVEL
</STRONG>
<PRE>
LINE



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v6.0



</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

This rule is meant to be parameterized with naming conventions by the 
application architect to enforce consistent access control operation in an 
application.



</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Weak Security Controls
category: Code Quality

Access control should be consistently applied in user management methods.

Enforcing this rule will help to protect against many of the OWASP Top 10 
application vulnerabilities, such as:

A4-Insecure Direct Object Reference
A5-Security Misconfiguration
A7-Missing Function Level Access Control

This rule helps to enforce the PCI DSS (Payment Card Industry Data Security 
Standard) Requirement #6: "Develop and maintain secure systems and applications"
and Requirement #8: "Assign a unique ID to each person with computer access".
Specifically, this rule helps to test for Issue 6.5.2: "Broken access control" 
and Issue 8.5.16: "Authenticate all access to any database containing cardholder 
data. This includes access by applications, administrators, and all other users".



</PRE>
<STRONG>
PARAMETERS
</STRONG>
<PRE>

-Access checking method names (in regular expressions)
 [qualified name of declaring type#method name]
    -The method declarations in which the centralized access control methods 
     must be invoked.
    -By default, the list is empty.  Custom values should be added to the list
     by the application architect.

-Centralized access control method names (in regular expressions)
 [qualified name of declaring type#method name]
    -The access control method calls which should be contained in all access
     checking methods.
    -By default, the list is empty.  Custom values should be added to the list
     by the application architect.



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

A consistent access control rule can be used to enforce protected entry points.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

If the parameters for this rule are not set, this rule will not flag any 
violations.  This test case assumes the following settings of the parameters:

Centralized access control method names (in regular expressions)
----------------------------------------------------------------
examples\.rules\.security\.wsc\.PACC#controlMethod

Access checking method names (in regular expressions)
-----------------------------------------------------
examples\.rules\.security\.wsc\.PACC#^access$

package examples.rules.security.wsc;

public class PACC {

   public void access(String u) {
       //VIOLATION- Access control method is not called from method specified
       //in "access checking method" parameter.
   }

   public void controlMethod(String u) { 
       //access control method
   }

   public void accessControlMethodTwo(String u) {
   }
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Always call access control methods to enforce consistent operation in any method
specified in the "Access checking method names" parameter.

package examples.rules.security.wsc;

public class PACCFixed {

   public void access(String u) {
       controlMethod(u);   //FIXED 
   }

   public void controlMethod(String u) { 
       //access control method
   }

   public void accessControlMethodTwo(String u) {
   }
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

OWASP Top 10 2013:
<A HREF="https://www.owasp.org/index.php/Top_10_2013-Top_10">https://www.owasp.org/index.php/Top_10_2013-Top_10</A>

OWASP API Security Top 10-2019
API7-Security Misconfiguration
<A HREF="https://github.com/OWASP/API-Security/blob/v1.4.1/2019/en/src/0xa7-security-misconfiguration.md">https://github.com/OWASP/API-Security/blob/v1.4.1/2019/en/src/0xa7-security-misconfiguration.md</A>

PCI Data Security Standard:
<A HREF="https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml">https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml</A>


</PRE>
<STRONG>
LOG
</STRONG>
<PRE>

@severity-from 4(v8.0)

</PRE>
</BODY>
</HTML>
