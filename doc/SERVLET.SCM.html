<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Ensure that all servlets have a corresponding mapping in 'web.xml' files [SERVLET.SCM]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Ensure that all servlets have a corresponding mapping in 'web.xml' files [SERVLET.SCM]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

Each servlet defined in a 'web.xml' file should have a corresponding servlet 
mapping defined in the same 'web.xml' file.  If a servlet is missing a mapping
to a URL pattern, it will cause the servlet to be inaccessible.  Missing 
mappings can be difficult to find because they will not be caught by the 
validator even when you are using a schema or DTD.  A violation will be flagged 
for each '&lt;servlet&gt;' element in a 'web.xml' file which does not have a 
corresponding '&lt;servlet-mapping&gt;' element.


</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v8.4


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Unsafe Environment Configuration

Servlets which are missing a mapping to a URL pattern in a 'web.xml' file are
useless because they are inaccessible.  Omitting a servlet mapping will cause a
denial of access.


</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

See the "SECURITY RELEVANCE" section.


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

The servlet "ExampleServlet" is missing a mapping to a URL pattern.

web.xml:

&lt;web-app xmlns="<A HREF="http://java.sun.com/xml/ns/j2ee">http://java.sun.com/xml/ns/j2ee</A>"
        xmlns:xsi="<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>"
        xsi:schemaLocation="<A HREF="http://java.sun.com/xml/ns/j2ee">http://java.sun.com/xml/ns/j2ee</A> <A HREF="http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd</A>"
        version="2.4"&gt;    
     
    &lt;servlet&gt;
        &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;  &lt;!-- VIOLATION: Missing a 
                                                      mapping to a URL pattern --&gt;
        &lt;servlet-class&gt;examples.rules.servlet.ExampleServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
     
&lt;/web-app&gt;


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Add a mapping to a URL pattern for each servlet.

web.xml:

&lt;web-app xmlns="<A HREF="http://java.sun.com/xml/ns/j2ee">http://java.sun.com/xml/ns/j2ee</A>"
        xmlns:xsi="<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>"
        xsi:schemaLocation="<A HREF="http://java.sun.com/xml/ns/j2ee">http://java.sun.com/xml/ns/j2ee</A> <A HREF="http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd</A>"
        version="2.4"&gt; 
            
    &lt;servlet&gt;
        &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;examples.rules.servlet.ExampleServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;  &lt;!-- FIXED: Added a mapping for the servlet --&gt;
        &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/ExampleServlet&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;


</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

Cigital Java Security Rulepack # 27:
<A HREF="http://www.cigital.com/securitypack/view/index.html">http://www.cigital.com/securitypack/view/index.html</A>

</PRE>
</BODY>
</HTML>
