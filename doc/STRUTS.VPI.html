<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Enable the Struts Validator plug-in in all 'struts-config.xml' files [STRUTS.VPI]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Enable the Struts Validator plug-in in all 'struts-config.xml' files [STRUTS.VPI]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

The Struts Validator plug-in can be enabled by adding an element like the
following in the 'struts-config.xml' file:

&lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;
    &lt;set-property property="pathnames" value="/org/apache/struts/validator/validator-rules.xml, /WEB-INF/validation.xml" /&gt;
&lt;/plug-in&gt;

We recommend always using the Validator plug-in with Struts forms.  This rule
will flag a violation for any 'struts-config.xml' file which does not contain a
'&lt;plug-in&gt;' element with the 'className' attribute set to "org.apache.struts.
validator.ValidatorPlugIn".  If a 'struts-config.xml' file does not contain such
a '&lt;plug-in&gt;' element, it will not use the Validator plug-in.


</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v8.4


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Unsafe Environment Configuration

Using the Struts Validator plug-in can help to prevent attacks such as denial of 
service attacks and injection attacks.  We recommend always using the Validator
plug-in in 'struts-config.xml' files to enable validation for Struts forms.


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

The sample 'struts-config.xml' file shown below does not use the Struts 
Validator plug-in to validate the form data.

struts-config.xml:

&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;!DOCTYPE struts-config PUBLIC 
    "-//Apache Software Foundation//DTD Struts Configuration 1.3//EN" 
    "<A HREF="http://struts.apache.org/dtds/struts-config_1_3.dtd">http://struts.apache.org/dtds/struts-config_1_3.dtd</A>"&gt;
&lt;struts-config&gt;  &lt;!-- VIOLATION: This 'struts-config.xml' file does not enable 
                      the Validator plug-in --&gt;

    &lt;form-beans&gt;
    
        &lt;form-bean name="loginForm" type="org.apache.struts.validator.DynaValidatorForm"&gt;
            &lt;form-property name="name_login" type="java.lang.String" /&gt;
            &lt;form-property name="password_login" type="core.EncryptedPassword" /&gt;
        &lt;/form-bean&gt;
        
        &lt;form-bean name="colorForm" type="org.apache.struts.action.DynaActionForm"&gt;                           
            &lt;form-property name="color" type="java.lang.String" /&gt;
            &lt;form-property name="hue" type="java.lang.String" /&gt;
        &lt;/form-bean&gt;
    
    &lt;/form-beans&gt;

&lt;/struts-config&gt;
 

</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Enable the Struts Validator plug-in by adding an appropriate '&lt;plug-in&gt;' element,
and add the necessary files for proper validation specified in the links to the
Struts documentation in the "REFERENCES" section.

struts-config.xml:
    
&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;!DOCTYPE struts-config PUBLIC 
    "-//Apache Software Foundation//DTD Struts Configuration 1.3//EN" 
    "<A HREF="http://struts.apache.org/dtds/struts-config_1_3.dtd">http://struts.apache.org/dtds/struts-config_1_3.dtd</A>"&gt;
&lt;struts-config&gt;
    &lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;
        &lt;set-property property="pathnames" value="/org/apache/struts/validator/validator-rules.xml, /WEB-INF/validation.xml" /&gt;
    &lt;/plug-in&gt;  &lt;!-- FIXED: Added a '&lt;plug-in&gt;' element which enables the Struts
                     Validator plug-in --&gt;

    &lt;form-beans&gt;
    
        &lt;form-bean name="loginForm" type="org.apache.struts.validator.DynaValidatorForm"&gt;
            &lt;form-property name="name_login" type="java.lang.String" /&gt;
            &lt;form-property name="password_login" type="core.EncryptedPassword" /&gt;
        &lt;/form-bean&gt;
        
        &lt;form-bean name="colorForm" type="org.apache.struts.action.DynaActionForm"&gt;                           
            &lt;form-property name="color" type="java.lang.String" /&gt;
            &lt;form-property name="hue" type="java.lang.String" /&gt;
        &lt;/form-bean&gt;
    
    &lt;/form-beans&gt;

&lt;/struts-config&gt; 



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. Cigital Java Security Rule Pack # 52:
<A HREF="http://www.cigital.com/securitypack/view/index.html">http://www.cigital.com/securitypack/view/index.html</A>

2. Struts 1.3.10 Documentation:
<A HREF="http://struts.apache.org/release/1.3.x/userGuide/index.html">http://struts.apache.org/release/1.3.x/userGuide/index.html</A>
<A HREF="http://struts.apache.org/release/1.3.x/faqs/validator.html">http://struts.apache.org/release/1.3.x/faqs/validator.html</A>

3. OWASP API Security Top 10-2019
API8-Injection
<A HREF="https://github.com/OWASP/API-Security/blob/v1.4.1/2019/en/src/0xa8-injection.md">https://github.com/OWASP/API-Security/blob/v1.4.1/2019/en/src/0xa8-injection.md</A>

</PRE>
</BODY>
</HTML>
