<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Avoid starting, stopping, or managing threads in any way in bean classes [EJB.THREAD]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Avoid starting, stopping, or managing threads in any way in bean classes [EJB.THREAD]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

This rule identifies code that manually starts, stops, or manages threads in any
way in an enterprise bean. An error is reported for each method call made on an
object of type "java.lang.Thread", "java.lang.ThreadType", or one of their
subtypes.

A class is considered a bean class if it meets one of the following:
    1. Implements "javax.ejb.EnterpriseBean" or a subinterface ("EntityBean",
       "MessageDrivenBean", "SessionBean")
    2. Has the annotation "javax.ejb.MessageDriven", "java.ejb.Stateful",
       "javax.ejb.Stateless", or "javax.persistence.Entity"
    3. Is denoted as an Entity, MessageDriven, Stateful, or Stateless bean in
       "ejb-jar.xml"


</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v4.5


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Deadlocks and Race Conditions

See BENEFITS.


</PRE>
<STRONG>
PARAMETERS
</STRONG>
<PRE>

-Maximum depth to check for Thread or ThreadGroup usage (default "2")
    This parameter allows for indirect checking of Thread or ThreadGroup method
    calls. Specifying a value of "1" will only check for direct calls to these
    methods. A value of "2" will check if any of the methods called from the web
    component in turn call a Thread or ThreadGroup method, and so on.
    Note that using a large value may significantly slow execution of the rule.


</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

This eliminates the possibility of conflicts with the EJB container's
responsibility to manage locking, threading, and concurrency issues.

According to the EJB specification (version 3.0):
"The enterprise bean must not attempt to manage threads. The enterprise bean
must not attempt to start, stop, suspend, or resume a thread, or to change a
thread's priority or name. The enterprise bean must not attempt to manage thread
groups."


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

package examples.rules.ejb;

import javax.ejb.*;

@Stateless
public class THREAD {
    void testMethod(Thread t) {
        t.run(); //VIOLATION
    }
    ...
}


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Remove any usage of Thread and ThreadGroup from the bean class.


</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

Enterprise JavaBeans Programming restrictions on EJB 
by Sanjay Mahapatra  -- JavaWorld August 2000

Sections 21.1.2 (p. 546) of the EJB specification (version 3.0).
The EJB specification is available online at <A HREF="http://java.sun.com/products/ejb/docs.html">http://java.sun.com/products/ejb/docs.html</A>

</PRE>
</BODY>
</HTML>
