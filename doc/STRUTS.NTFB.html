<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Specify a name and type for each form bean in 'struts-config.xml' files [STRUTS.NTFB]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Specify a name and type for each form bean in 'struts-config.xml' files [STRUTS.NTFB]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

The 'struts-config.xml' file is used to configure the names and types of all the
form beans used by a Struts application.  Each '&lt;form-bean&gt;' element in this 
file must specify both a non-empty "name" attribute and a non-empty "type" 
attribute.  This rule will flag a violation for each '&lt;form-bean&gt;' element in a
'struts-config.xml' file which does not specify either a "name" or a "type"
attribute or which specifies an empty String for the "name" or "type" attribute.
The rule will flag a violation for cases where there is a "name" or "type" 
attribute consisting entirely of whitespace characters.


</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v8.4


</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

Missing "name" and "type" attributes will be caught by the XML validator if you 
are using the Struts DTD for validation.  We recommend always using the Struts 
DTD for validation.  This rule will catch errors in files in which you forget to 
use the DTD as well as errors in files in which you do not notice any validation 
error(s).  Also, this rule will catch errors for cases where there is an empty 
"name" or "type" attribute or a "name" or "type" attribute consisting entirely 
of whitespace characters.  The Struts DTD will not check for cases where there 
is an empty "name" or "type" attribute.


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Unsafe Environment Configuration

Failure to specify a name and type for each form bean in a 'struts-config.xml' 
file may cause the form bean to be inaccessible.  In other words, this failure
will cause a denial of access.


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

The following sample 'struts-config.xml' file references the form bean 
"logonForm" in the "/LogonSubmit" action, but this will not work because the 
definition of this form bean is missing the "name" attribute.

struts-config.xml:

&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;struts-config&gt;
    &lt;form-beans&gt;
        &lt;form-bean
            type="examples.rules.struts.LogonForm"/&gt;  &lt;!-- VIOLATION: missing "name" attribute --&gt;
    &lt;/form-beans&gt;
    &lt;action-mappings&gt;
        &lt;action
            path="/Welcome"
            forward="/pages/Welcome.jsp"/&gt;
        &lt;action
            path="/Logon"
            forward="/pages/Logon.jsp"/&gt;
        &lt;action
            path="/LogonSubmit"
            type="examples.rules.struts.LogonAction"
            name="logonForm"
            scope="request"
            validate="true"
            input="/pages/Logon.jsp"&gt;
            &lt;forward
                name="success"
                path="/pages/Welcome.jsp"/&gt;
            &lt;forward
                name="failure"
                path="/pages/Logon.jsp"/&gt;
        &lt;/action&gt;
        &lt;action
            path="/Logoff"
            type="examples.rules.struts.LogoffAction"&gt;
            &lt;forward
                name="success"
                path="/pages/Logoff.jsp"/&gt;
        &lt;/action&gt;
    &lt;/action-mappings&gt;
    &lt;message-resources parameter="resources.application"/&gt;
&lt;/struts-config&gt;


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Ensure that each '&lt;form-bean&gt;' element contains a non-empty "name" attribute and
a non-empty "type" attribute.  Use the Struts DTD so that the XML validator will 
check for missing "name" and "type" attributes for you.  

struts-config.xml:

&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;!DOCTYPE struts-config PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 1.3//EN"
    "<A HREF="http://struts.apache.org/dtds/struts-config_1_3.dtd">http://struts.apache.org/dtds/struts-config_1_3.dtd</A>"&gt;  &lt;!-- FIXED: Use the Struts DTD for validation --&gt;
    
&lt;struts-config&gt;
    &lt;form-beans&gt;
        &lt;form-bean
            name="logonForm"
            type="examples.rules.struts.LogonForm"/&gt;  &lt;!-- FIXED: Added the "name" attribute --&gt;
    &lt;/form-beans&gt;
    &lt;action-mappings&gt;
        &lt;action
            path="/Welcome"
            forward="/pages/Welcome.jsp"/&gt;
        &lt;action
            path="/Logon"
            forward="/pages/Logon.jsp"/&gt;
        &lt;action
            path="/LogonSubmit"
            type="examples.rules.struts.LogonAction"
            name="logonForm"
            scope="request"
            validate="true"
            input="/pages/Logon.jsp"&gt;
            &lt;forward
                name="success"
                path="/pages/Welcome.jsp"/&gt;
            &lt;forward
                name="failure"
                path="/pages/Logon.jsp"/&gt;
        &lt;/action&gt;
        &lt;action
            path="/Logoff"
            type="examples.rules.struts.LogoffAction"&gt;
            &lt;forward
                name="success"
                path="/pages/Logoff.jsp"/&gt;
        &lt;/action&gt;
    &lt;/action-mappings&gt;
    &lt;message-resources parameter="resources.application"/&gt;
&lt;/struts-config&gt;


</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. Struts 1.3.10 Documentation:
<A HREF="http://struts.apache.org/release/1.3.x/userGuide/index.html">http://struts.apache.org/release/1.3.x/userGuide/index.html</A>

2. Cigital Java Security Rulepack # 36 and # 37:
<A HREF="http://www.cigital.com/securitypack/view/index.html">http://www.cigital.com/securitypack/view/index.html</A>

</PRE>
</BODY>
</HTML>
