<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Use wrapper methods instead of calling dangerous or problematic methods directly (custom rule) [SECURITY.WSC.UWM]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Use wrapper methods instead of calling dangerous or problematic methods directly (custom rule) [SECURITY.WSC.UWM]
</STRONG>
<p>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

This rule checks that the methods specified in the parameters as "dangerous"
are not called directly by the user but are instead called using a wrapper 
method.  With the default setting of the parameters, this rule will check 
nothing.  It must be customized.  Once methods are added to the parameter list,
a violation will be flagged for each case where one of the "dangerous/
problematic" methods is called outside of the corresponding wrapper method.



</PRE>
<STRONG>
SCOPE LEVEL
</STRONG>
<PRE>
LINE



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v8.0


</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

This rule is similar to the rules SECURITY.WSC.CACM and SECURITY.WSC.CAM.  It is a more general 
version of these two rules.

This rule has a quickfix to replace the call to a dangerous method with a call
to a wrapper method, but the quickfix is only available if certain conditions 
are met.  The conditions are:

1.  The method specified as the wrapper for a dangerous method must exist and 
    must be accessible from the place where the dangerous method call is made.
    Be careful when entering parameters, as typos will cause the quickfix not to 
    work.  
    
2.  The method specified as the wrapper must have the same signature as the 
    method being replaced.  That is, it must have the same types of exceptions
    thrown, same return type, and same number and types of parameters.
 
3.  The method specified as the wrapper must either be static, defined in the
    same type as the dangerous method that is being replaced, or defined in the
    same class as the class in which the dangerous method call is made (For this 
    last case, the quickfix will only work if the enclosing method declaration 
    is non-"static").
 
These limitations on the quickfix help to ensure that the quickfix will not 
cause compilation errors.  None of this validation can be performed at the
time values are entered for the parameters, so you should be careful to enter a
method which satisfies these conditions if you plan to use the quickfix.  In 
cases where a quickfix is not available, the violation should be fixed manually.      


</PRE>
<STRONG>
SECURITY RELEVANCE
</STRONG>
<PRE>

category: Weak Security Controls

Enforcing this rule will help to protect against the OWASP 2013 Top 10 
application vulnerability "A9-Using Components with Known Vulnerabilities".

See BENEFITS section.



</PRE>
<STRONG>
PARAMETERS
</STRONG>
<PRE>

-Methods which should be wrapped and their wrapper methods
 (Specify methods in the format &lt;fully qualified type name&gt;#&lt;method name&gt;)
     -By default, the table is empty.
     -Example: To specify that the method "dangerous()" in the class "examples.
      rules.security.wsc.UWM" must be called from the wrapper method "wrapper()",
      you would add the following values to the table:
         -Dangerous/Problematic Method: examples.rules.security.wsc.UWM#dangerous
         -Wrapper: examples.rules.security.wsc.UWM#wrapper
         

</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Centralizing calls to "dangerous/problematic" methods allows the user to enforce 
a single point of failure.  It also makes it easier to confirm that these 
methods are called correctly.


</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

This example assumes that an entry has been added to the parameter table with
"examples.rules.security.wsc.UWM#dangerous" as the "dangerous/problematic" method and 
"examples.rules.security.wsc.UWM#wrapper" as the wrapper method.

package examples.rules.security.wsc;

public class UWM {
    public int method() {
        return dangerous();  //VIOLATION
    }

    public int dangerous() {
        //Some dangerous operation
        return 1;
    }

    public int wrapper() {
        return dangerous();
    }
}


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

Call the corresponding wrapper method instead of calling the "dangerous/
problematic" method directly.

package examples.rules.security.wsc;

public class UWMFixed {
    public int method() {
        return wrapper();  //FIXED
    }

    public int dangerous() {
        //Some dangerous operation
        return 1;
    }

    public int wrapper() {
        return dangerous();
    }
}


</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

OWASP Top 10 2013 (A9-Using Components with Known Vulnerabilities):
<A HREF="https://www.owasp.org/index.php/Top_10_2013-Top_10">https://www.owasp.org/index.php/Top_10_2013-Top_10</A>

</PRE>
</BODY>
</HTML>
